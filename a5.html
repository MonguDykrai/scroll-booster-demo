<script>
  const json = [
    { "id": "2", "pid": "" },
    { "id": "4", "pid": "2" },
    { "id": "8", "pid": "4" }
  ]

  function toTree(json, arrRes) {
    json.forEach((outerItem, index) => {
      if (outerItem.pid == "") {
        arrRes.push({
          ...outerItem,
          children: []
        });
        json.splice(index, 1)
      } else {
        json.forEach(innerItem => {
          if (outerItem.pid == innerItem.id) {
            console.log(outerItem.pid)
            console.log(arrRes)
          }
        });
      }
    });

    // toTree(json, arrRes)

    return arrRes;
  }

  const tree = toTree(json, []);
  console.log(tree)
</script>